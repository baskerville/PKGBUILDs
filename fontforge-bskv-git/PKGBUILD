# Maintainer: Bastien Dejean <baskerville@lavabit.com>

pkgname=fontforge-bskv-git
pkgver=20130405
ftver="2.4.11"
pkgrel=1
pkgdesc='An outline and bitmap font editor'
arch=('i686' 'x86_64')
url='http://fontforge.sourceforge.net/'
license=('custom:BSD')
makedepends=('git')
optdepends=('libpng' 'libtiff' 'giflib' 'libjpeg' 'libxml2' 'libspiro' 'libunicodenames' 'libiconv' 'freetype2')
conflicts=('fontforge')
provides=('fontforge')
source=("http://downloads.sourceforge.net/project/freetype/freetype2/${ftver}/freetype-${ftver}.tar.bz2")
md5sums=('b93435488942486c8d0ca22e8f768034')

_gitroot='git@github.com:fontforge/fontforge.git'
_gitname='fontforge'

build() {
    cd "$srcdir"
    if [ -d "$_gitname" ] ; then
        cd "$_gitname" && git pull origin
    else
        git clone "$_gitroot" "$_gitname"
    fi

    rm -rf "$srcdir/${_gitname}-build"
    git clone "$srcdir/$_gitname" "$srcdir/${_gitname}-build"
    cd "$srcdir/${_gitname}-build"

    ./autogen.sh
    ./configure --prefix=/usr --with-freetype-source=../freetype-${ftver} PYTHON=python2
    make
}

package() {
    cd "$srcdir/${_gitname}-build"
    make DESTDIR="$pkgdir" install
    install -D -m644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
